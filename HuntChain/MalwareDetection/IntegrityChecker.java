package MalwareDetection;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;

public class IntegrityChecker extends SignatureDetection {

    protected String fullHash;
    private String fileName;


    public IntegrityChecker(String filePath) {
        super(filePath);
        scanFile(new File(filePath));
    }


    public void scanFile(File file){

        fullHash = super.SHAsum(readToByte(file),"SHA-256");
        fileName = file.getName();
        //System.out.println(fullHash);

    }

    public String getHash(){
        return fullHash;
    }

    public String getFileName(){
        return fileName;
    }


    private byte[] readToByte(File file){
        FileInputStream fis = null;

        byte[] buf = new byte[(int) file.length()];

        try{
            fis = new FileInputStream(file);
            fis.read(buf);
            fis.close();

        }catch (IOException io){
            io.printStackTrace();
        }

        return buf;
    }
}
