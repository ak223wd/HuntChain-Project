package MalwareDetection;

import java.io.File;
import java.security.MessageDigest;

public class SignatureDetection implements InterfaceSignatureDetection{

    private String filePath;
    public SignatureDetection(String filePath) {
        this.filePath = filePath;
    }


    @Override
    public void scanFileAndCombine(File file, int nbrByte) {

    }

    @Override
    public String SHAsum(byte[] data, String hashFunc) {
        try {
            //This MessageDigest class provides applications the functionality of a message digest algorithm
            MessageDigest digestMessage = MessageDigest.getInstance(hashFunc); //to get to use SHA256

            byte[] input = digestMessage.digest(data);
            String hexString = "";
            for (int i=0; i<input.length;i++){
                String hex = Integer.toHexString(0xff & input[i]);
                if(hex.length()==1){
                    hexString+='0';
                }
                hexString+=hex;
            }


            return hexString;
        } catch (Exception e){

            throw new RuntimeException();
        }
    }



}
